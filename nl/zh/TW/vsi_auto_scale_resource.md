---

copyright:
  years: 2014, 2019
lastupdated: "2019-06-07"

keywords:

subcollection: virtual-servers

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}

# 使用資源型自動調整來管理資料流量激增
{: #managing-resourced-based-auto-scaling}

發表新產品或促銷現有產品，可能導致網站中的資料流量激增。資料流量激增可能會影響您的回應時間，進而影響您客戶的網站體驗。{{site.data.keyword.cloud}} 自動調整可讓您自動回應資料流量激增。您可以使用資源型自動調整來控制這些資料流量激增。
{:shortdesc}

## 開始之前
首先，導覽至裝置功能表，並確定您具有完成作業所需的正確帳戶許可權。

* 導覽至主控台的裝置功能表。如需相關資訊，請參閱[導覽至裝置](/docs/vsi?topic=virtual-servers-navigating-devices)。
* 確保您具有任何必要的帳戶許可權及裝置存取權。如果您不是帳戶管理者，則您的使用者帳戶必須包含許可權，才能使用自動調整。如需更新許可權以使用自動調整的相關資訊，請參閱[設定使用者許可權進行自動調整](/docs/vsi?topic=virtual-servers-user-permissions-required-to-use-auto-scale)。只有帳戶擁有者或具有**管理使用者**標準基礎架構許可權的使用者才能調整許可權。 

如需許可權的相關資訊，請參閱[傳統基礎架構許可權](/docs/iam?topic=iam-infrapermission#infrapermission)和[管理裝置存取權](/docs/vsi?topic=virtual-servers-managing-device-access)。

## 新增自動調整群組
{: #adding-auto-scale-group}

例如，座落於德克薩斯州達拉斯的電子商務網站需要三部虛擬伺服器隨時上線。當公司舉行線上銷售時，業務會在平日的上午 9:00 與下午 5:00 之間激增。為了協助維持網站回應時間，在這些時段期間，需要多加三部虛擬伺服器。此外，在所有虛擬伺服器中，公用入埠資料流量的平均值超過每秒 5 MB 且持續 10 分鐘時，應該再佈建兩部虛擬伺服器。當資料流量低於每秒 5 MB 時，應該取消並移除這些額外的虛擬伺服器。目標是處理資料流量突波的虛擬伺服器不超過五部，這使得平日虛擬伺服器不會受到額外的平日資料流量影響。下列步驟將引導您如何設定自動調整以支援以資源為基礎的調整。

1. 從**裝置**功能表中，選取**自動調整**。
2. 選取**新增自動調整群組**。
3. 首先藉由輸入**群組名稱**（例如，Weekend Scale Up Group）來設定自動調整群組，然後選取資料中心。
4. 選取伺服器終止原則。比方說，如果您選擇**最舊**，則在縮減時會選取佈建日期最早的伺服器。
5. 指出您的群組是否為多重 VLAN 調整群組，以及如何跨已配置的 VLAN 配對平衡縮減。
6. 選取您想要在其上佈建伺服器的公用及專用 VLAN。如果要從公用網際網路存取伺服器（如果 VLAN 正在執行 Web 伺服器），請將**僅限專用網路**保持清除狀態。
7. 將**成員計數下限**設為 3，並將**成員計數上限**設為 6。再將**緩和期間**設為 0。因為這是以排程為基礎的調整，所以沒有收集任何統計資料來觸發調整動作。

## 定義群組的成員配置
{: #defining-member-configuration}

1. 找出**成員配置**，並輸入調整伺服器的**主機名稱**及**網域**。新增至群組的後續伺服器則具有附加至主機名稱的唯一字尾。
2. 指定運算實例（核心、RAM 等）的硬體配置。
3. 如果想要安裝最小作業系統，請選取作業系統。您也可以使用**公用映像檔**或**專用映像檔**來佈建實例。
4. 如果實例需要額外步驟來安裝其他軟體，請指定**後置安裝 Script** 的 URL 來安裝軟體（如果您對群組使用負載平衡器，則在成員置於負載平衡器後面之前，會先執行後置安裝 Script）。

## 設定原則
{: #setting-up-policies}

在情境中，電子商務網站使用以資源為基礎的調整。需要兩個原則：一個對所需時間範圍具有 +3 的相對調整動作，第二個為激增結束時，具有 3 的絕對動作。第一個原則是新增資源。

1. 向下捲動至**原則**，然後按一下**新增原則**。輸入**原則名稱** (Weekday Scale Up)。
2. 選取**緩和期間**的群組緩和選項。
3. 按一下**新增觸發程式**，並在第一個下拉功能表中選取**每隔**來指定重複觸發程式，然後從後續的下拉方框中強調顯示**星期一、星期二、星期三、星期四**和**星期五**，以及**下午 2:00**。（**進階編輯**勾選框可讓您在 crontab 之類的表示法中輸入觸發頻率。）
4. 按一下**動作**下的**調整方式**下拉方框，然後選取**確切**。在**成員**欄位中輸入 3。
5. 再次按一下**新增原則**，以指定每個下午移除伺服器的第二個原則。緩和期間與群組的緩和相同。觸發程式是每星期一、星期二、星期三、星期四及星期五下午 10:00，確切的調整動作為 3。在**觸發程式**欄位中輸入的時間是以 UTC 時間為基礎，這就是您為何需要選取下午 2:00 代表上午 9:00 美國中部夏令時間，以及下午 10:00 代表下午 5:00 美國中部夏令時間的原因。在美國中部標準時間期間，時間將為下午 1:00 與下午 9:00，因為 UTC/GMT 未確認「日光節約時間」。如需時間轉換器，請參閱 [World Time Server ![外部鏈結圖示](../../icons/launch-glyph.svg "外部鏈結圖示")](http://www.worldtimeserver.com/current_time_in_UTC.aspx){: new_window} 網站。
6. 設定緩和為 0 的另一個群組，例如，名為 Traffic Burst Group，且成員計數下限為 0，上限為 5。請對群組及成員配置使用與 Weekday Scale Up 群組相同的設定，但群組名稱除外。
7. 按一下**新增原則**來新增第二個原則，以在所有虛擬伺服器中，公用入埠資料流量的平均值超過每秒 5 MB 且持續 10 分鐘時，控制兩部額外的伺服器。
8. 輸入**原則名稱**，例如 Traffic Burst Group。
9. 選取**緩和期間**的群組緩和選項。
10. 按一下**新增觸發程式**。在第一個方框中留下預設的**如果我的**，並對第二個方框選取**公用網路送入的 Mbps**。在第三個方框中留下預設的 > 符號。在第四個方框中，輸入 **5** (5 MB)，在第五個方框中輸入 **600**，然後在最後一個方框中選取**秒**來代表 10 分鐘。
11. 按一下**動作**下的**調整方式**下拉方框，然後選取**相對**。在**成員**欄位中輸入 2。
12. 再次按一下**新增原則**，以指定資料流量減少至低於 5 Mbps 時移除伺服器的第二個原則。緩和期間將與群組的緩和相同。觸發程式為如果我的公用網路送入的 Mbps 小於 5 (5 Mbps)，期間為 600 秒（10 分鐘）。

建立這兩個群組時，Weekday Scale Up 群組最少會建立三部伺服器。在平日的上午 9:00 中部時間，再新增三部伺服器，並於下午 5:00 中部時間移除這些伺服器。沒有其他方式可在該群組中新增或移除成員。在完全獨立的 Traffic Burst Group 中，如果所有成員中的入埠公用資料流量平均值為每秒 5 MB 且持續 10 分鐘，每次都會新增兩部伺服器，直到它達到群組上限五為止。在入埠公用資料流量持續低於該數量 10 分鐘之後，即會移除此群組中的所有伺服器。

